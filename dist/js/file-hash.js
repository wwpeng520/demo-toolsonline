$(function(){var a=document.getElementById("files");a.addEventListener("change",handleFileSelect,false);a.addEventListener("change",calculate,false);$("#files").on("change",function(){$("#hashTable").css("display","block")})});function handleFileSelect(b){var d=b.target.files;for(var c=0,e;e=d[c];c++){if(!e.type.match("image.*")){continue}var a=new FileReader();a.onload=(function(f){return function(h){var g=document.createElement("span");g.innerHTML=['<img class="thumb" src="',h.target.result,'" title="',f.name,'"/>'].join("");document.getElementById("list").insertBefore(g,null)}})(e);a.readAsDataURL(e)}}function calculateMD5Hash(f,e){var d=Q.defer();var g=new FileReader();var j=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;var b=new SparkMD5();var i=Math.ceil(f.size/e);var a=0;var c=new Date().getTime();g.onload=function(l){a+=1;d.notify({currentPart:a,totalParts:i});var k=l.target.result;b.appendBinary(k);if(a<i){h();return}d.resolve({hashResult:b.end(),duration:new Date().getTime()-c})};g.onerror=function(k){d.reject(k)};function h(){var l=a*e;var k=Math.min(l+e,f.size);g.readAsBinaryString(j.call(f,l,k))}h();return d.promise}function calculate(){var a=document.getElementById("files");if(!a.files.length){return}var b=a.files[0];var c=Math.pow(1024,2)*10;calculateMD5Hash(b,c).then(function(d){var h,g,f;var e=document.getElementsByTagName("tr");h=document.createElement("tr");g=document.createElement("td");f=document.createElement("td");g.innerHTML="MD5";f.innerHTML=d.hashResult;h.appendChild(g);h.appendChild(f);$("#hashTable").append(h)})};